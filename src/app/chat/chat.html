<div *ngIf="!isReady" class="loading">
  Loading chat...
</div>

<div class="container">

  <!-- LEFT PANEL (USERS) -->
  <div class="users">
    <h3>ðŸ’¬ Users</h3>

    <div *ngFor="let u of users"
        (click)="selectUser(u)"
        class="user-item"
        [class.active]="u === selectedUser">
      {{u.name}}
    </div>
  </div>

  <!-- RIGHT PANEL (CHAT) -->
  <div class="chat">

    <div class="chat-header">
      <h3>Logged in as: <span>{{username}}</span></h3>
      <h4>Chat with: <span>{{selectedUser?.name || 'Select a user'}}</span></h4>
    </div>

    <!-- IMPORTANT: #scrollMe is used for auto-scroll -->
    <div class="messages" #scrollMe>

      <div *ngFor="let m of messages"
           [ngClass]="{'mine': m.includes('You:') || m.includes(username), 
                       'other': !(m.includes('You:') || m.includes(username))}">

        <div class="sender">
          {{ (m.includes('You:') || m.includes(username)) ? 'You' : selectedUser?.name }}
        </div>

        <div class="text">
          {{
            m
            .replace(username + ':', '')
            .replace(selectedUser?.name + ':', '')
            .replace('You:', '')
            .trim()
          }}
        </div>

      </div>
    </div>

    <div class="input-area">
      <input [(ngModel)]="message" placeholder="Type message..." />
      <button (click)="send()">Send</button>
    </div>

  </div>
</div>